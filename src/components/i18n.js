import i18n from 'i18next';
import { initReactI18next } from 'react-i18next';
import LanguageDetector from 'i18next-browser-languagedetector';

// State to track custom translations
let customTranslations = {};

const STORAGE_KEY = 'translations_';

const saveLanguage = (language) => {
  localStorage.setItem('selectedLanguage', language);
};

const getSavedLanguage = () => {
  return localStorage.getItem('selectedLanguage');
};

export const saveTranslation = (language, key, value) => {
  if (!customTranslations[language]) {
    customTranslations[language] = {};
  }
  customTranslations[language][key] = value;

  // Update i18n resources immediately
  const currentBundle = i18n.getResourceBundle(language, 'translation');
  i18n.addResourceBundle(
    language,
    'translation',
    { ...currentBundle, [key]: value },
    true,
    true
  );
};

export const getStoredTranslation = (language, key) => {
  return customTranslations[language]?.[key] || null;
};

// Language change handler
const handleLanguageChange = (lng) => {
  document.documentElement.dir = ['ar', 'fa', 'ur'].includes(lng) ? 'rtl' : 'ltr';
  document.documentElement.lang = lng;
};

const loadStoredTranslations = () => {
  const languages = ['ar', 'en', 'fr', 'tr', 'id', 'ru', 'hi', 'ur', 'bn', 'zh', 'tl', 'fa'];
  
  languages.forEach(lang => {
    try {
      // Get stored translations
      const storageKey = STORAGE_KEY + lang;
      const storedTranslations = localStorage.getItem(storageKey);
      
      if (!storedTranslations) return;

      // Parse stored translations
      const translations = JSON.parse(storedTranslations);
      
      // Skip if no translations or invalid format
      if (!translations || typeof translations !== 'object') return;

      // Get existing translations
      const existingTranslations = i18n.getResourceBundle(lang, 'translation') || {};

      // Merge translations
      const mergedTranslations = {
        ...existingTranslations,
        ...translations
      };

      // Update i18n bundle
      i18n.addResourceBundle(
        lang,
        'translation',
        mergedTranslations,
        true,
        true
      );

      // Update in-memory translations
      if (!customTranslations[lang]) {
        customTranslations[lang] = {};
      }
      customTranslations[lang] = {
        ...customTranslations[lang],
        ...translations
      };
    } catch (error) {
      console.error(`Failed to load translations for ${lang}:`, error);
    }
  });
};

i18n
  .use(LanguageDetector)
  .use(initReactI18next)
  .init({
    resources: {
      ar: {
        translation: {
          "Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©": "Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©",
          "Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©": "Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",
          "Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª": "Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª",
          "Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…": "Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…",
          "Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©": "Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©",
          "ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø¥Ø³Ù„Ø§Ù…ÙŠØ©": "ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø¥Ø³Ù„Ø§Ù…ÙŠØ©",
          "Ù…ÙˆØ§Ù‚Ø¹ Ø¥Ø³Ù„Ø§Ù…ÙŠØ© Ø£Ø®Ø±Ù‰": "Ù…ÙˆØ§Ù‚Ø¹ Ø¥Ø³Ù„Ø§Ù…ÙŠØ© Ø£Ø®Ø±Ù‰",
          "Ù…Ù†Ø§ÙØ¹ Ù„Ù„Ø¹Ù„ÙˆÙ… Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©": "Ù…Ù†Ø§ÙØ¹ Ù„Ù„Ø¹Ù„ÙˆÙ… Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©",
          "Ù…Ù†ØµØ© ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø¥Ø³Ù„Ø§Ù…ÙŠØ© Ù…ØªÙƒØ§Ù…Ù„Ø© ØªÙ‚Ø¯Ù… Ø¯Ø±ÙˆØ³Ø§Ù‹ ÙˆÙ…Ø­Ø§Ø¶Ø±Ø§Øª ÙÙŠ Ø§Ù„Ø¹Ù„ÙˆÙ… Ø§Ù„Ø´Ø±Ø¹ÙŠØ© ÙˆØ§Ù„ØªØ±Ø¨ÙˆÙŠØ© Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø¹ØµØ±ÙŠ Ù…ÙÙŠØ³Ù‘Ø±": "Ù…Ù†ØµØ© ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø¥Ø³Ù„Ø§Ù…ÙŠØ© Ù…ØªÙƒØ§Ù…Ù„Ø© ØªÙ‚Ø¯Ù… Ø¯Ø±ÙˆØ³Ø§Ù‹ ÙˆÙ…Ø­Ø§Ø¶Ø±Ø§Øª ÙÙŠ Ø§Ù„Ø¹Ù„ÙˆÙ… Ø§Ù„Ø´Ø±Ø¹ÙŠØ© ÙˆØ§Ù„ØªØ±Ø¨ÙˆÙŠØ© Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø¹ØµØ±ÙŠ Ù…ÙÙŠØ³Ù‘Ø±",
          "Ø£Ø­Ø¯Ø« Ø§Ù„Ø¯Ø±ÙˆØ³": "Ø£Ø­Ø¯Ø« Ø§Ù„Ø¯Ø±ÙˆØ³",
          "Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø¯Ø±ÙˆØ³": "Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø¯Ø±ÙˆØ³",
          "Ø´Ø§Ø±ÙƒÙ†Ø§ Ø±Ø£ÙŠÙƒ": "Ø´Ø§Ø±ÙƒÙ†Ø§ Ø±Ø£ÙŠÙƒ",
          "Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ùƒ Ù‡Ù†Ø§...": "Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ùƒ Ù‡Ù†Ø§...",
          "ØªÙ… Ø¨Ù†Ø¬Ø§Ø­!": "ØªÙ… Ø¨Ù†Ø¬Ø§Ø­!",
          "ØªÙ… Ø¥Ø±Ø³Ø§Ù„ ØªÙ‚ÙŠÙŠÙ…Ùƒ Ø¨Ù†Ø¬Ø§Ø­ØŒ Ø´ÙƒØ±Ø§Ù‹ Ù„Ùƒ!": "ØªÙ… Ø¥Ø±Ø³Ø§Ù„ ØªÙ‚ÙŠÙŠÙ…Ùƒ Ø¨Ù†Ø¬Ø§Ø­ØŒ Ø´ÙƒØ±Ø§Ù‹ Ù„Ùƒ!",
          "Ø¥ØºÙ„Ø§Ù‚": "Ø¥ØºÙ„Ø§Ù‚",
          "Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…": "Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…",
          "Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª": "Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª",
          "Ø§Ù„Ø¹Ù‚ÙŠØ¯Ø©": "Ø§Ù„Ø¹Ù‚ÙŠØ¯Ø©",
          "Ø§Ù„ÙÙ‚Ù‡": "Ø§Ù„ÙÙ‚Ù‡",
          "ØªÙØ³ÙŠØ± Ø§Ù„Ù‚Ø±Ø¢Ù†": "ØªÙØ³ÙŠØ± Ø§Ù„Ù‚Ø±Ø¢Ù†",
          "Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ù†Ø¨ÙˆÙŠØ©": "Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ù†Ø¨ÙˆÙŠØ©",
          "Ø§Ù„Ø­Ø¯ÙŠØ«": "Ø§Ù„Ø­Ø¯ÙŠØ«",
          "Ø§Ù„Ø£Ø®Ù„Ø§Ù‚": "Ø§Ù„Ø£Ø®Ù„Ø§Ù‚",
          "Ø§Ù„Ø¹Ù„ÙˆÙ… Ø§Ù„ØªØ±Ø¨ÙˆÙŠØ©": "Ø§Ù„Ø¹Ù„ÙˆÙ… Ø§Ù„ØªØ±Ø¨ÙˆÙŠØ©",
          "Ù…ÙƒØªØ¨Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©": "Ù…ÙƒØªØ¨Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©",
          "Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ù…ÙŠØ²Ø© Ù…Ù† Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª ÙˆØ§Ù„Ø¯Ø±ÙˆØ³ ÙÙŠ Ø¹Ù„ÙˆÙ… Ø§Ù„Ø´Ø±ÙŠØ¹Ø© ÙˆØ§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ù†Ø¨ÙˆÙŠØ©": "Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ù…ÙŠØ²Ø© Ù…Ù† Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª ÙˆØ§Ù„Ø¯Ø±ÙˆØ³ ÙÙŠ Ø¹Ù„ÙˆÙ… Ø§Ù„Ø´Ø±ÙŠØ¹Ø© ÙˆØ§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ù†Ø¨ÙˆÙŠØ©",
          "ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ù…Ø®ØªØ§Ø±Ø©": "ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ù…Ø®ØªØ§Ø±Ø©",
          "ÙƒØªØ¨ Ù…Ø®ØªØ§Ø±Ø©": "ÙƒØªØ¨ Ù…Ø®ØªØ§Ø±Ø©",
          "Ù…ÙƒØªØ¨Ø© Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©": "Ù…ÙƒØªØ¨Ø© Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©",
          "Ù…ÙƒØªØ¨Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©": "Ù…ÙƒØªØ¨Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©",
          "Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©": "Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©",
          "Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©": "Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©",
          "Ù…Ù†Ø§ÙØ¹ - Ù…Ù†ØµØ© ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø¥Ø³Ù„Ø§Ù…ÙŠØ©": "Ù…Ù†Ø§ÙØ¹ - Ù…Ù†ØµØ© ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø¥Ø³Ù„Ø§Ù…ÙŠØ©",
          "Ø®Ø·Ø£!": "Ø®Ø·Ø£!",
          'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©': 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©',
      'Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª': 'Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª',
      'Ø§Ù„ÙƒØªØ¨': 'Ø§Ù„ÙƒØªØ¨',
      'Ø¹Ù†_Ø§Ù„Ù…Ù†Ø§ÙØ¹': 'Ø¹Ù† Ø§Ù„Ù…Ù†Ø§ÙØ¹',
      'Ø§ØªØµÙ„_Ø¨Ù†Ø§': 'Ø§ØªØµÙ„ Ø¨Ù†Ø§',
      'ØªØ³Ø¬ÙŠÙ„_Ø§Ù„Ø¯Ø®ÙˆÙ„': 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„',
      'ØªØ³Ø¬ÙŠÙ„_Ø§Ù„Ø®Ø±ÙˆØ¬': 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬',
      'Ù„ÙˆØ­Ø©_Ø§Ù„ØªØ­ÙƒÙ…': 'Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…',

      // Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
      'Ø´Ø§Ø±ÙƒÙ†Ø§_Ø±Ø£ÙŠÙƒ': 'Ø´Ø§Ø±ÙƒÙ†Ø§ Ø±Ø£ÙŠÙƒ',
      'Ø§ÙƒØªØ¨_ØªØ¹Ù„ÙŠÙ‚Ùƒ': 'Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ùƒ Ù‡Ù†Ø§...',
      'Ø¥Ø±Ø³Ø§Ù„_Ø§Ù„ØªÙ‚ÙŠÙŠÙ…': 'Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…',
      'Ù†Ø¬Ø§Ø­': 'ØªÙ… Ø¨Ù†Ø¬Ø§Ø­!',
      'Ù†Ø¬Ø§Ø­_Ø§Ù„ØªÙ‚ÙŠÙŠÙ…': 'ØªÙ… Ø¥Ø±Ø³Ø§Ù„ ØªÙ‚ÙŠÙŠÙ…Ùƒ Ø¨Ù†Ø¬Ø§Ø­ØŒ Ø´ÙƒØ±Ø§Ù‹ Ù„Ùƒ!',
      'Ø¥ØºÙ„Ø§Ù‚': 'Ø¥ØºÙ„Ø§Ù‚',
      'Ø®Ø·Ø£': 'Ø®Ø·Ø£!',
      'Ø¥Ø¶Ø§ÙØ©_ÙÙŠØ¯ÙŠÙˆ_Ø¬Ø¯ÙŠØ¯': 'Ø¥Ø¶Ø§ÙØ© ÙÙŠØ¯ÙŠÙˆ Ø¬Ø¯ÙŠØ¯',
      'Ø¹Ù†ÙˆØ§Ù†_Ø§Ù„ÙÙŠØ¯ÙŠÙˆ': 'Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙÙŠØ¯ÙŠÙˆ',
      'Ø£Ø¯Ø®Ù„_Ø¹Ù†ÙˆØ§Ù†_Ø§Ù„ÙÙŠØ¯ÙŠÙˆ': 'Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙÙŠØ¯ÙŠÙˆ',
      'Ù†ÙˆØ¹_Ø§Ù„ÙÙŠØ¯ÙŠÙˆ': 'Ù†ÙˆØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ',
      'ÙŠÙˆØªÙŠÙˆØ¨': 'ÙŠÙˆØªÙŠÙˆØ¨',
      'Ø±ÙØ¹_Ù…Ù†_Ø§Ù„Ø¬Ù‡Ø§Ø²': 'Ø±ÙØ¹ Ù…Ù† Ø§Ù„Ø¬Ù‡Ø§Ø²',
      'Ø±Ø§Ø¨Ø·_Ø§Ù„ÙÙŠØ¯ÙŠÙˆ': 'Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ',
      'Ø£Ø¯Ø®Ù„_Ø±Ø§Ø¨Ø·_ÙŠÙˆØªÙŠÙˆØ¨': 'Ø£Ø¯Ø®Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù…Ù† ÙŠÙˆØªÙŠÙˆØ¨',
      'Ù…Ù„Ù_Ø§Ù„ÙÙŠØ¯ÙŠÙˆ': 'Ù…Ù„Ù Ø§Ù„ÙÙŠØ¯ÙŠÙˆ',
      'Ø¥Ø¶Ø§ÙØ©': 'Ø¥Ø¶Ø§ÙØ©',
      'Ø¥Ù„ØºØ§Ø¡': 'Ø¥Ù„ØºØ§Ø¡',
      'ØªØ¹Ø¯ÙŠÙ„_Ø§Ù„Ù†Øµ': 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù†Øµ',
      'Ø­ÙØ¸': 'Ø­ÙØ¸',
      'Ø§Ù„Ù†Øµ': 'Ø§Ù„Ù†Øµ',
      'Ø¹Ø±Ø¶_Ø§Ù„Ù…Ø²ÙŠØ¯': 'Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø²ÙŠØ¯',

      // Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø®Ø·Ø£
      'Ø§Ù„Ø±Ø¬Ø§Ø¡_ØªØ³Ø¬ÙŠÙ„_Ø§Ù„Ø¯Ø®ÙˆÙ„': 'ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø³Ø¤ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹',
      'Ø£Ø¯Ø®Ù„_Ø§Ù„Ø¹Ù†ÙˆØ§Ù†': 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙÙŠØ¯ÙŠÙˆ',
      'Ø£Ø¯Ø®Ù„_Ø§Ù„Ø±Ø§Ø¨Ø·': 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ',
      'Ø§Ø®ØªØ±_Ø§Ù„Ù…Ù„Ù': 'ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Ø§Ù„ÙÙŠØ¯ÙŠÙˆ',
      'Ø®Ø·Ø£_Ø§Ù„Ø¥Ø¶Ø§ÙØ©': 'Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ',
          "ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø¹Ø¯Ø¯ Ø§Ù„Ù†Ø¬ÙˆÙ… ÙˆÙƒØªØ§Ø¨Ø© ØªØ¹Ù„ÙŠÙ‚ Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„": "ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø¹Ø¯Ø¯ Ø§Ù„Ù†Ø¬ÙˆÙ… ÙˆÙƒØªØ§Ø¨Ø© ØªØ¹Ù„ÙŠÙ‚ Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„",
          "Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙƒØªØ¨": "Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙƒØªØ¨",
          "Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ù…ÙŠØ²Ø© Ù…Ù† Ø§Ù„ÙƒØªØ¨ ÙÙŠ Ø¹Ù„ÙˆÙ… Ø§Ù„Ø´Ø±ÙŠØ¹Ø© ÙˆØ§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ù†Ø¨ÙˆÙŠØ©": "Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ù…ÙŠØ²Ø© Ù…Ù† Ø§Ù„ÙƒØªØ¨ ÙÙŠ Ø¹Ù„ÙˆÙ… Ø§Ù„Ø´Ø±ÙŠØ¹Ø© ÙˆØ§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ù†Ø¨ÙˆÙŠØ©",
          "Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„Ù‘ÙÙ€Ù‡Ù Ø§Ù„Ø±Ù‘ÙØ­Ù’Ù…ÙÙ€Ù°Ù†Ù Ø§Ù„Ø±Ù‘ÙØ­ÙÙŠÙ…Ù": "Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„Ù‘ÙÙ€Ù‡Ù Ø§Ù„Ø±Ù‘ÙØ­Ù’Ù…ÙÙ€Ù°Ù†Ù Ø§Ù„Ø±Ù‘ÙØ­ÙÙŠÙ…Ù",
          "ğŸŒ™ Ø´Ù‡Ø± Ø±Ù…Ø¶Ø§Ù† Ù…Ø¨Ø§Ø±Ùƒ ğŸŒ™": "ğŸŒ™ Ø´Ù‡Ø± Ø±Ù…Ø¶Ø§Ù† Ù…Ø¨Ø§Ø±Ùƒ ğŸŒ™",
          "Ù„Ù… ÙŠØªÙ… ØªÙ„Ù‚ÙŠ Ø£ÙŠ Ø±Ø¯ Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…. ÙŠÙØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.": "Ù„Ù… ÙŠØªÙ… ØªÙ„Ù‚ÙŠ Ø£ÙŠ Ø±Ø¯ Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…. ÙŠÙØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.",
          "Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ù…ÙŠØ²Ø© Ù…Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ© Ø§Ù„Ù…ÙÙŠØ¯Ø©": "Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ù…ÙŠØ²Ø© Ù…Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ© Ø§Ù„Ù…ÙÙŠØ¯Ø©",
          "ï´¿ Ø´ÙÙ‡Ù’Ø±Ù Ø±ÙÙ…ÙØ¶ÙØ§Ù†Ù Ø§Ù„Ù‘ÙØ°ÙÙŠ Ø£ÙÙ†Ø²ÙÙ„Ù ÙÙÙŠÙ‡Ù Ø§Ù„Ù’Ù‚ÙØ±Ù’Ø¢Ù†Ù Ù‡ÙØ¯Ù‹Ù‰ Ù„Ù‘ÙÙ„Ù†Ù‘ÙØ§Ø³Ù ÙˆÙØ¨ÙÙŠÙ‘ÙÙ†ÙØ§ØªÙ Ù…Ù‘ÙÙ†Ù Ø§Ù„Ù’Ù‡ÙØ¯ÙÙ‰Ù° ÙˆÙØ§Ù„Ù’ÙÙØ±Ù’Ù‚ÙØ§Ù†Ù Ûš ÙÙÙ…ÙÙ† Ø´ÙÙ‡ÙØ¯Ù Ù…ÙÙ†ÙƒÙÙ…Ù Ø§Ù„Ø´Ù‘ÙÙ‡Ù’Ø±Ù ÙÙÙ„Ù’ÙŠÙØµÙÙ…Ù’Ù‡Ù Û– ÙˆÙÙ…ÙÙ† ÙƒÙØ§Ù†Ù Ù…ÙØ±ÙÙŠØ¶Ù‹Ø§ Ø£ÙÙˆÙ’ Ø¹ÙÙ„ÙÙ‰Ù° Ø³ÙÙÙØ±Ù ÙÙØ¹ÙØ¯Ù‘ÙØ©ÙŒ Ù…Ù‘ÙÙ†Ù’ Ø£ÙÙŠÙ‘ÙØ§Ù…Ù Ø£ÙØ®ÙØ±Ù Û— ÙŠÙØ±ÙÙŠØ¯Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù Ø¨ÙÙƒÙÙ…Ù Ø§Ù„Ù’ÙŠÙØ³Ù’Ø±Ù ÙˆÙÙ„ÙØ§ ÙŠÙØ±ÙÙŠØ¯Ù Ø¨ÙÙƒÙÙ…Ù Ø§Ù„Ù’Ø¹ÙØ³Ù’Ø±Ù ÙˆÙÙ„ÙØªÙÙƒÙ’Ù…ÙÙ„ÙÙˆØ§ Ø§Ù„Ù’Ø¹ÙØ¯Ù‘ÙØ©Ù ÙˆÙÙ„ÙØªÙÙƒÙØ¨Ù‘ÙØ±ÙÙˆØ§ Ø§Ù„Ù„Ù‘ÙÙ‡Ù Ø¹ÙÙ„ÙÙ‰Ù° Ù…ÙØ§ Ù‡ÙØ¯ÙØ§ÙƒÙÙ…Ù’ ÙˆÙÙ„ÙØ¹ÙÙ„Ù‘ÙÙƒÙÙ…Ù’ ØªÙØ´Ù’ÙƒÙØ±ÙÙˆÙ†Ù ï´¾": "ï´¿ Ø´ÙÙ‡Ù’Ø±Ù Ø±ÙÙ…ÙØ¶ÙØ§Ù†Ù Ø§Ù„Ù‘ÙØ°ÙÙŠ Ø£ÙÙ†Ø²ÙÙ„Ù ÙÙÙŠÙ‡Ù Ø§Ù„Ù’Ù‚ÙØ±Ù’Ø¢Ù†Ù Ù‡ÙØ¯Ù‹Ù‰ Ù„Ù‘ÙÙ„Ù†Ù‘ÙØ§Ø³Ù ÙˆÙØ¨ÙÙŠÙ‘ÙÙ†ÙØ§ØªÙ Ù…Ù‘ÙÙ†Ù Ø§Ù„Ù’Ù‡ÙØ¯ÙÙ‰Ù° ÙˆÙØ§Ù„Ù’ÙÙØ±Ù’Ù‚ÙØ§Ù†Ù Ûš ÙÙÙ…ÙÙ† Ø´ÙÙ‡ÙØ¯Ù Ù…ÙÙ†ÙƒÙÙ…Ù Ø§Ù„Ø´Ù‘ÙÙ‡Ù’Ø±Ù ÙÙÙ„Ù’ÙŠÙØµÙÙ…Ù’Ù‡Ù Û– ÙˆÙÙ…ÙÙ† ÙƒÙØ§Ù†Ù Ù…ÙØ±ÙÙŠØ¶Ù‹Ø§ Ø£ÙÙˆÙ’ Ø¹ÙÙ„ÙÙ‰Ù° Ø³ÙÙÙØ±Ù ÙÙØ¹ÙØ¯Ù‘ÙØ©ÙŒ Ù…Ù‘ÙÙ†Ù’ Ø£ÙÙŠÙ‘ÙØ§Ù…Ù Ø£ÙØ®ÙØ±Ù Û— ÙŠÙØ±ÙÙŠØ¯Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù Ø¨ÙÙƒÙÙ…Ù Ø§Ù„Ù’ÙŠÙØ³Ù’Ø±Ù ÙˆÙÙ„ÙØ§ ÙŠÙØ±ÙÙŠØ¯Ù Ø¨ÙÙƒÙÙ…Ù Ø§Ù„Ù’Ø¹ÙØ³Ù’Ø±Ù ÙˆÙÙ„ÙØªÙÙƒÙ’Ù…ÙÙ„ÙÙˆØ§ Ø§Ù„Ù’Ø¹ÙØ¯Ù‘ÙØ©Ù ÙˆÙÙ„ÙØªÙÙƒÙØ¨Ù‘ÙØ±ÙÙˆØ§ Ø§Ù„Ù„Ù‘ÙÙ‡Ù Ø¹ÙÙ„ÙÙ‰Ù° Ù…ÙØ§ Ù‡ÙØ¯ÙØ§ÙƒÙÙ…Ù’ ÙˆÙÙ„ÙØ¹ÙÙ„Ù‘ÙÙƒÙÙ…Ù’ ØªÙØ´Ù’ÙƒÙØ±ÙÙˆÙ†Ù ï´¾",
          "Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ù…ÙŠØ²Ø© Ù…Ù† Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ© Ø§Ù„Ù…ÙÙŠØ¯Ø©": "Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ù…ÙŠØ²Ø© Ù…Ù† Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ© Ø§Ù„Ù…ÙÙŠØ¯Ø©",
        }
      },
      en: {
        translation: {
          "Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©": "English",
          "Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©": "Home",
          "Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª": "Videos",
          "Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…": "Al Qur'an Al Kareem",
          "Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©": "Interactive files",
          "ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø¥Ø³Ù„Ø§Ù…ÙŠØ©": "Islamic applications",
          "Ù…ÙˆØ§Ù‚Ø¹ Ø¥Ø³Ù„Ø§Ù…ÙŠØ© Ø£Ø®Ø±Ù‰": "Another Islamic sites",
          "Ù…Ù†Ø§ÙØ¹ Ù„Ù„Ø¹Ù„ÙˆÙ… Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©": "Manafea for Islamic Sciences",
          "Ù…Ù†ØµØ© ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø¥Ø³Ù„Ø§Ù…ÙŠØ© Ù…ØªÙƒØ§Ù…Ù„Ø© ØªÙ‚Ø¯Ù… Ø¯Ø±ÙˆØ³Ø§Ù‹ ÙˆÙ…Ø­Ø§Ø¶Ø±Ø§Øª ÙÙŠ Ø§Ù„Ø¹Ù„ÙˆÙ… Ø§Ù„Ø´Ø±Ø¹ÙŠØ© ÙˆØ§Ù„ØªØ±Ø¨ÙˆÙŠØ© Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø¹ØµØ±ÙŠ Ù…ÙÙŠØ³Ù‘Ø±": "An integrated Islamic educational platform offering lessons and lectures in Sharia and educational sciences in a modern, simplified style",
          "Ø£Ø­Ø¯Ø« Ø§Ù„Ø¯Ø±ÙˆØ³": "Latest Lessons",
          "Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø¯Ø±ÙˆØ³": "View More Lessons",
          "Ø´Ø§Ø±ÙƒÙ†Ø§ Ø±Ø£ÙŠÙƒ": "Share Your Opinion",
          "Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ùƒ Ù‡Ù†Ø§...": "Write your comment here...",
          "ØªÙ… Ø¨Ù†Ø¬Ø§Ø­!": "Success!",
          "ØªÙ… Ø¥Ø±Ø³Ø§Ù„ ØªÙ‚ÙŠÙŠÙ…Ùƒ Ø¨Ù†Ø¬Ø§Ø­ØŒ Ø´ÙƒØ±Ø§Ù‹ Ù„Ùƒ!": "Your feedback has been sent successfully, thank you!",
          "Ø¥ØºÙ„Ø§Ù‚": "Close",
          "Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª": "All Videos",
          "Ø§Ù„Ø¹Ù‚ÙŠØ¯Ø©": "Aqeedah (Creed)",
          "Ø§Ù„ÙÙ‚Ù‡": "Fiqh (Jurisprudence)",
          "ØªÙØ³ÙŠØ± Ø§Ù„Ù‚Ø±Ø¢Ù†": "Quran Interpretation",
          "Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ù†Ø¨ÙˆÙŠØ©": "Prophetic Biography",
          "Ø§Ù„Ø­Ø¯ÙŠØ«": "Hadith",
          "Ø§Ù„Ø£Ø®Ù„Ø§Ù‚": "Ethics",
          "Ø§Ù„Ø¹Ù„ÙˆÙ… Ø§Ù„ØªØ±Ø¨ÙˆÙŠØ©": "Educational Sciences",
          "Ù…ÙƒØªØ¨Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©": "Islamic Videos Library",
          "Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ù…ÙŠØ²Ø© Ù…Ù† Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª ÙˆØ§Ù„Ø¯Ø±ÙˆØ³ ÙÙŠ Ø¹Ù„ÙˆÙ… Ø§Ù„Ø´Ø±ÙŠØ¹Ø© ÙˆØ§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ù†Ø¨ÙˆÙŠØ©": "A distinguished collection of lectures and lessons in Sharia sciences and Prophetic biography",
          "ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ù…Ø®ØªØ§Ø±Ø©": "Selected Videos",
          "ÙƒØªØ¨ Ù…Ø®ØªØ§Ø±Ø©": "Selected Books",
          "Ù…ÙƒØªØ¨Ø© Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©": "Islamic Books Library",
          "Ù…ÙƒØªØ¨Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©": "Islamic Applications Library",
          "Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©": "Islamic Websites Library",
          "Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©": "All Rights Reserved",
          "Ù…Ù†Ø§ÙØ¹ - Ù…Ù†ØµØ© ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø¥Ø³Ù„Ø§Ù…ÙŠØ©": "Manafea - Islamic Educational Platform",
          "Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…": "Submit Feedback",
          "Ø®Ø·Ø£!": "Error!",
          "ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø¹Ø¯Ø¯ Ø§Ù„Ù†Ø¬ÙˆÙ… ÙˆÙƒØªØ§Ø¨Ø© ØªØ¹Ù„ÙŠÙ‚ Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„": "Please select the number of stars and write a comment before submitting",
          "Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙƒØªØ¨": "All Books",
          "Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ù…ÙŠØ²Ø© Ù…Ù† Ø§Ù„ÙƒØªØ¨ ÙÙŠ Ø¹Ù„ÙˆÙ… Ø§Ù„Ø´Ø±ÙŠØ¹Ø© ÙˆØ§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ù†Ø¨ÙˆÙŠØ©": "A distinguished collection of books in Sharia sciences and Prophetic biography",
          "Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„Ù‘ÙÙ€Ù‡Ù Ø§Ù„Ø±Ù‘ÙØ­Ù’Ù…ÙÙ€Ù°Ù†Ù Ø§Ù„Ø±Ù‘ÙØ­ÙÙŠÙ…Ù": "In the name of Allah, the Most Gracious, the Most Merciful",
          "Ù„Ù… ÙŠØªÙ… ØªÙ„Ù‚ÙŠ Ø£ÙŠ Ø±Ø¯ Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…. ÙŠÙØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.": "No response was received from the server. Please check your internet connection.",
          "ğŸŒ™ Ø´Ù‡Ø± Ø±Ù…Ø¶Ø§Ù† Ù…Ø¨Ø§Ø±Ùƒ ğŸŒ™": "ğŸŒ™ Blessed Ramadan Month ğŸŒ™",
          "Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ù…ÙŠØ²Ø© Ù…Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ© Ø§Ù„Ù…ÙÙŠØ¯Ø©": "A distinguished collection of useful Islamic applications",
          "ï´¿ Ø´ÙÙ‡Ù’Ø±Ù Ø±ÙÙ…ÙØ¶ÙØ§Ù†Ù Ø§Ù„ÙÙ‘Ø°ÙÙŠ Ø£ÙÙ†Ø²ÙÙ„Ù ÙÙÙŠÙ‡Ù Ø§Ù„Ù’Ù‚ÙØ±Ù’Ø¢Ù†Ù Ù‡ÙØ¯Ù‹Ù‰ Ù„ÙÙ‘Ù„Ù†ÙÙ‘Ø§Ø³Ù ÙˆÙØ¨ÙÙŠÙÙ‘Ù†ÙØ§ØªÙ Ù…ÙÙ‘Ù†Ù Ø§Ù„Ù’Ù‡ÙØ¯ÙÙ‰Ù° ÙˆÙØ§Ù„Ù’ÙÙØ±Ù’Ù‚ÙØ§Ù†Ù Ûš ÙÙÙ…ÙÙ† Ø´ÙÙ‡ÙØ¯Ù Ù…ÙÙ†ÙƒÙÙ…Ù Ø§Ù„Ø´ÙÙ‘Ù‡Ù’Ø±Ù ÙÙÙ„Ù’ÙŠÙØµÙÙ…Ù’Ù‡Ù Û– ÙˆÙÙ…ÙÙ† ÙƒÙØ§Ù†Ù Ù…ÙØ±ÙÙŠØ¶Ù‹Ø§ Ø£ÙÙˆÙ’ Ø¹ÙÙ„ÙÙ‰Ù° Ø³ÙÙÙØ±Ù ÙÙØ¹ÙØ¯ÙÙ‘Ø©ÙŒ Ù…ÙÙ‘Ù†Ù’ Ø£ÙÙŠÙÙ‘Ø§Ù…Ù Ø£ÙØ®ÙØ±Ù Û— ÙŠÙØ±ÙÙŠØ¯Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø¨ÙÙƒÙÙ…Ù Ø§Ù„Ù’ÙŠÙØ³Ù’Ø±Ù ÙˆÙÙ„ÙØ§ ÙŠÙØ±ÙÙŠØ¯Ù Ø¨ÙÙƒÙÙ…Ù Ø§Ù„Ù’Ø¹ÙØ³Ù’Ø±Ù ÙˆÙÙ„ÙØªÙÙƒÙ’Ù…ÙÙ„ÙÙˆØ§ Ø§Ù„Ù’Ø¹ÙØ¯ÙÙ‘Ø©Ù ÙˆÙÙ„ÙØªÙÙƒÙØ¨ÙÙ‘Ø±ÙÙˆØ§ Ø§Ù„Ù’Ù„ÙÙ‘Ù‡Ù Ø¹ÙÙ„ÙÙ‰Ù° Ù…ÙØ§ Ù‡ÙØ¯ÙØ§ÙƒÙÙ…Ù’ ÙˆÙÙ„ÙØ¹ÙÙ„ÙÙ‘ÙƒÙÙ…Ù’ Ø´ÙÙƒÙØ±ÙÙˆÙ†Ù ï´¾": "The month of Ramadan in which was revealed the Quran, a guidance for mankind and clear proofs for the guidance and the criterion (between right and wrong). So whoever of you sights (the crescent on the first night of) the month (of Ramadan), he must fast that month, and whoever is ill or on a journey, the same number (of days which one did not fast must be made up) from other days. Allah intends for you ease, and He does not want to make things difficult for you. (He wants that you) must complete the same number (of days), and that you must magnify Allah for having guided you so that you may be grateful to Him.",
          "Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ù…ÙŠØ²Ø© Ù…Ù† Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ© Ø§Ù„Ù…ÙÙŠØ¯Ø©": "A distinguished collection of useful Islamic websites",
        }
      },
    },
    fallbackLng: 'ar',
    detection: {
      order: ['localStorage', 'navigator'],
    },
    interpolation: {
      escapeValue: false,
    },
  });

// Add language change listener
i18n.on('languageChanged', handleLanguageChange);

// Initial language setup
handleLanguageChange(i18n.language);

const savedLanguage = getSavedLanguage();
if (savedLanguage) {
  i18n.changeLanguage(savedLanguage);
}

export const changeLanguage = async (lng) => {
  await i18n.changeLanguage(lng);
  handleLanguageChange(lng);
  // Load stored translations for the new language
  const storageKey = STORAGE_KEY + lng;
  const storedTranslations = localStorage.getItem(storageKey);
  if (storedTranslations) {
    const translations = JSON.parse(storedTranslations);
    if (translations && typeof translations === 'object') {
      i18n.addResourceBundle(lng, 'translation', translations, true, true);
    }
  }
};

export { saveLanguage, getSavedLanguage };
export const getDirection = (language) => {
  return ['ar', 'fa', 'ur'].includes(language) ? 'rtl' : 'ltr';
};

export default i18n;